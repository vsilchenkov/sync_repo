#Использовать messenger

Перем Телеграм;

&Пластилин
Перем Настройки;

&Пластилин
Перем НаборЭмодзи;

Перем ПозицияСообщения;

Процедура ВЛог(Знач ТекстСообщения, Ошибка = Ложь,  Эмодзи = "") Экспорт
	
	Если Не Настройки.ПараметрыТелеграм.ОтправлятьСообщения Тогда
		Возврат;		
	КонецЕсли;

	Если Ошибка Тогда
		НаборЭмодзи.ДобавитьВНачалоСтроки(ТекстСообщения, НаборЭмодзи.Ошибка());
	Иначе
		Если ЗначениеЗаполнено(Эмодзи) Тогда
			НаборЭмодзи.ДобавитьВНачалоСтроки(ТекстСообщения, Эмодзи);
		Иначе
			ПозицияСообщения = ПозицияСообщения + 1;
			НаборЭмодзи.ДобавитьВНачалоСтроки(ТекстСообщения, НаборЭмодзи.Цифра(ПозицияСообщения));
		КонецЕсли;
	КонецЕсли;
	
	ТипСообщения = "html";
	Телеграм.ОтправитьСообщение("telegram", 
									Настройки.ПараметрыТелеграм.BotID, 
									ТекстСообщения, , ТипСообщения);	
	
КонецПроцедуры

Процедура УстановитьТокен(Токен) Экспорт
	Телеграм.ИнициализироватьТранспорт("telegram", Новый Структура("Логин", Токен));	
КонецПроцедуры

&Желудь
Процедура ПриСозданииОбъекта()
	
	Телеграм = Новый Мессенджер();	
	ПозицияСообщения = 0;

КонецПроцедуры